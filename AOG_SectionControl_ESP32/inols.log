






Started logging.

<<<
Content-Length: 3164

{"jsonrpc":"2.0","id":0,"method":"initialize","params":{"processId":1396,"clientInfo":{"name":"vscode","version":"1.53.2"},"rootPath":"f:\\Eigene Dateien\\GitHub\\AOG_SectionControl_ESP32\\AOG_SectionControl_ESP32","rootUri":"file:///f%3A/Eigene%20Dateien/GitHub/AOG_SectionControl_ESP32/AOG_SectionControl_ESP32","capabilities":{"workspace":{"applyEdit":true,"workspaceEdit":{"documentChanges":true,"resourceOperations":["create","rename","delete"],"failureHandling":"textOnlyTransactional"},"didChangeConfiguration":{"dynamicRegistration":true},"didChangeWatchedFiles":{"dynamicRegistration":true},"symbol":{"dynamicRegistration":true,"symbolKind":{"valueSet":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]}},"executeCommand":{"dynamicRegistration":true},"configuration":true,"workspaceFolders":true},"textDocument":{"publishDiagnostics":{"relatedInformation":true,"versionSupport":false,"tagSupport":{"valueSet":[1,2]}},"synchronization":{"dynamicRegistration":true,"willSave":true,"willSaveWaitUntil":true,"didSave":true},"completion":{"dynamicRegistration":true,"contextSupport":true,"completionItem":{"snippetSupport":true,"commitCharactersSupport":true,"documentationFormat":["markdown","plaintext"],"deprecatedSupport":true,"preselectSupport":true,"tagSupport":{"valueSet":[1]}},"completionItemKind":{"valueSet":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25]}},"hover":{"dynamicRegistration":true,"contentFormat":["markdown","plaintext"]},"signatureHelp":{"dynamicRegistration":true,"signatureInformation":{"documentationFormat":["markdown","plaintext"],"parameterInformation":{"labelOffsetSupport":true}},"contextSupport":true},"definition":{"dynamicRegistration":true,"linkSupport":true},"references":{"dynamicRegistration":true},"documentHighlight":{"dynamicRegistration":true},"documentSymbol":{"dynamicRegistration":true,"symbolKind":{"valueSet":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]},"hierarchicalDocumentSymbolSupport":true},"codeAction":{"dynamicRegistration":true,"isPreferredSupport":true,"codeActionLiteralSupport":{"codeActionKind":{"valueSet":["","quickfix","refactor","refactor.extract","refactor.inline","refactor.rewrite","source","source.organizeImports"]}}},"codeLens":{"dynamicRegistration":true},"formatting":{"dynamicRegistration":true},"rangeFormatting":{"dynamicRegistration":true},"onTypeFormatting":{"dynamicRegistration":true},"rename":{"dynamicRegistration":true,"prepareSupport":true},"documentLink":{"dynamicRegistration":true,"tooltipSupport":true},"typeDefinition":{"dynamicRegistration":true,"linkSupport":true},"implementation":{"dynamicRegistration":true,"linkSupport":true},"colorProvider":{"dynamicRegistration":true},"foldingRange":{"dynamicRegistration":true,"rangeLimit":5000,"lineFoldingOnly":true},"declaration":{"dynamicRegistration":true,"linkSupport":true},"selectionRange":{"dynamicRegistration":true}},"window":{"workDoneProgress":true}},"initializationOptions":{},"trace":"off","workspaceFolders":[{"uri":"file:///f%3A/Eigene%20Dateien/GitHub/AOG_SectionControl_ESP32/AOG_SectionControl_ESP32","name":"AOG_SectionControl_ESP32"}]}}
>>>
Content-Length: 936

{"jsonrpc":"2.0","id":0,"result":{"capabilities":{"textDocumentSync":{"openClose":true,"change":2,"save":{"includeText":true}},"completionProvider":{"triggerCharacters":[".","\u003c","\u003e",":","\"","/"],"allCommitCharacters":[" ","\t","(",")","[","]","{","}","\u003c","\u003e",":",";",",","+","-","/","*","%","^","\u0026","#","?",".","=","\"","'","|"],"completionItem":{}},"hoverProvider":{},"signatureHelpProvider":{"triggerCharacters":["(",","]},"definitionProvider":{},"documentHighlightProvider":{},"documentSymbolProvider":{},"codeActionProvider":{"codeActionKinds":["quickfix","refactor","info"]},"documentFormattingProvider":{},"documentRangeFormattingProvider":{},"documentOnTypeFormattingProvider":{"firstTriggerCharacter":"\n"},"renameProvider":{},"executeCommandProvider":{"commands":["clangd.applyFix","clangd.applyTweak"]},"workspaceSymbolProvider":{}},"serverInfo":{"name":"arduino-language-server","version":"0.7.4"}}}
<<<
Content-Length: 52

{"jsonrpc":"2.0","method":"initialized","params":{}}Content-Length: 59383

{"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///f%3A/Eigene%20Dateien/GitHub/AOG_SectionControl_ESP32/AOG_SectionControl_ESP32/zAOG_SC_WebInterface.ino","languageId":"cpp","version":1,"text":"\r\n// Wifi variables & definitions\r\nchar HTML_String[22000];\r\nint action;\r\nlong temLong = 0;\r\ndouble temDoub = 0;\r\n\r\n#define ACTION_LoadDefaultVal   1\r\n#define ACTION_RESTART          2\r\n#define ACTION_SET_WS_THRESHOLD 3\r\n\r\n\r\n\r\n\r\n//-------------------------------------------------------------------------------------------------\r\n//7. Maerz 2021\r\n\r\nvoid doWebinterface(void* pvParameters) {\r\n\tfor (;;){\r\n\t\tWiFi_Server.handleClient(); //does the Webinterface\r\n\t\tif (WebIOTimeOut < millis() + long((Set.timeoutWebIO * 60000)) - 3000) {//not called in the last 10 sec\r\n\t\t\tvTaskDelay(1500);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvTaskDelay(100);\r\n\t\t}\r\n\t\tif ((now > WebIOTimeOut) && (Set.timeoutWebIO != 255)) {\r\n\t\t\tWebIORunning = false;\r\n\t\t\tWiFi_Server.close();\r\n\t\t\tSerial.println(\"closing Webinterface task\");\r\n\t\t\tdelay(1);\r\n\t\t\tvTaskDelete(NULL);\r\n\t\t\tdelay(1);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n//-------------------------------------------------------------------------------------------------\r\n//7. Maerz 2021\r\n\r\nvoid handleRoot() {\r\n\tmake_HTML01();\r\n\tWiFi_Server.sendHeader(\"Connection\", \"close\");\r\n\tWiFi_Server.send(200, \"text/html\", HTML_String);\r\n\tWebIOTimeOut = millis() + long((Set.timeoutWebIO * 60000));\r\n\tif (Set.debugmode) {\r\n\t\tSerial.println(\"Webpage root\"); Serial.print(\"Timeout WebIO: \"); Serial.println(WebIOTimeOut);\r\n\t}\r\n\tprocess_Request();\r\n}\r\n\r\n//-------------------------------------------------------------------------------------------------\r\n//7. Maerz 2021\r\n\r\nvoid WiFiStartServer() {\t\r\n\r\n\tWiFi_Server.on(\"/\", HTTP_GET, []() {handleRoot(); });\r\n\r\n\t//file selection for firmware update\r\n\tWiFi_Server.on(\"/serverIndex\", HTTP_GET, []() {\r\n\t\tWiFi_Server.sendHeader(\"Connection\", \"close\");\r\n\t\tWiFi_Server.send(200, \"text/html\", serverIndex);\r\n\t\t});\r\n\t//handling uploading firmware file \r\n\tWiFi_Server.on(\"/update\", HTTP_POST, []() {\r\n\t\tWiFi_Server.sendHeader(\"Connection\", \"close\");\r\n\t\tWiFi_Server.send(200, \"text/plain\", (Update.hasError()) ? \"FAIL\" : \"OK\");\r\n\t\tESP.restart();\r\n\t\t}, []() {\r\n\t\t\tHTTPUpload& upload = WiFi_Server.upload();\r\n\t\t\tif (upload.status == UPLOAD_FILE_START) {\r\n\t\t\t\tSerial.printf(\"Update: %s\\n\", upload.filename.c_str());\r\n\t\t\t\tif (!Update.begin(UPDATE_SIZE_UNKNOWN)) { //start with max available size\r\n\t\t\t\t\tUpdate.printError(Serial);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if (upload.status == UPLOAD_FILE_WRITE) {\r\n\t\t\t\t// flashing firmware to ESP\r\n\t\t\t\tif (Update.write(upload.buf, upload.currentSize) != upload.currentSize) {\r\n\t\t\t\t\tUpdate.printError(Serial);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if (upload.status == UPLOAD_FILE_END) {\r\n\t\t\t\tif (Update.end(true)) { //true to set the size to the current progress\r\n\t\t\t\t\tSerial.printf(\"Update Success: %u\\nRebooting...\\n\", upload.totalSize);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tUpdate.printError(Serial);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\tWiFi_Server.onNotFound(handleNotFound);\r\n\r\n\tWiFi_Server.begin();\r\n}\r\n\r\n//---------------------------------------------------------------------\r\n// Process given values 10. Mai 2020\r\n//---------------------------------------------------------------------\r\nvoid process_Request()\r\n{\r\n\tint temInt = 0;\r\n\taction = 0;\r\n\tif (Set.debugmode) { Serial.print(\"From webinterface: number of arguments: \"); Serial.println(WiFi_Server.args()); }\r\n\tfor (byte n = 0; n < WiFi_Server.args(); n++) {\r\n\t\tif (Set.debugmode) {\r\n\t\t\tSerial.print(\"argName \"); Serial.print(WiFi_Server.argName(n));\r\n\t\t\tSerial.print(\" val: \"); Serial.println(WiFi_Server.arg(n));\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"ACTION\") {\r\n\t\t\taction = int(WiFi_Server.arg(n).toInt());\r\n\t\t\tif (Set.debugmode) { Serial.print(\"Action found: \"); Serial.println(action); }\r\n\t\t\tif (action != ACTION_RESTART) { EEprom_unblock_restart(); }\r\n\t\t\tif (action == ACTION_LoadDefaultVal) {\r\n\t\t\t\tif (Set.debugmode) { Serial.println(\"load default settings from EEPROM\"); }\r\n\t\t\t\tEEprom_read_default();\r\n\t\t\t\tdelay(2);\r\n\t\t\t}\r\n\t\t\tif (action == ACTION_SET_WS_THRESHOLD) {\r\n\t\t\t\tunsigned int WSThres_avg = 0;\r\n\t\t\t\tfor (int i = 0; i < 8; i++) {\r\n\t\t\t\t\tWSThres_avg += analogRead(Set.SectMainSW_PIN);\r\n\t\t\t\t\tdelay(100);\r\n\t\t\t\t}\r\n\t\t\t\tSet.HitchLevelVal = WSThres_avg >> 3;\r\n\t\t\t\tEEprom_write_all();\r\n\t\t\t}\r\n\t\t\tif (action == ACTION_RESTART) {\r\n\t\t\t\tSerial.println(\"reboot ESP32: selected by webinterface\");\r\n\t\t\t\tEEprom_block_restart();//prevents from restarting, when webpage is reloaded. Is set to 0, when other ACTION than restart is called\r\n\t\t\t\tdelay(1000);\r\n\t\t\t\tWiFi.disconnect();\r\n\t\t\t\tdelay(500);\r\n\t\t\t\tESP.restart();\r\n\t\t\t}\r\n\t\t}\r\n\t\t//save changes\r\n\t\tif (WiFi_Server.argName(n) == \"Save\") {\r\n\t\t\tif (Set.debugmode) { Serial.println(\"Save button pressed in webinterface\"); }\r\n\t\t\tEEprom_write_all();\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"SSID_MY1\") {\r\n\t\t\tfor (int i = 0; i < 24; i++) Set.ssid1[i] = 0x00;\r\n\t\t\ttemInt = WiFi_Server.arg(n).length() + 1;\r\n\t\t\tWiFi_Server.arg(n).toCharArray(Set.ssid1, temInt);\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"Password_MY1\") {\r\n\t\t\tfor (int i = 0; i < 24; i++) Set.password1[i] = 0x00;\r\n\t\t\ttemInt = WiFi_Server.arg(n).length() + 1;\r\n\t\t\tWiFi_Server.arg(n).toCharArray(Set.password1, temInt);\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"SSID_MY2\") {\r\n\t\t\tfor (int i = 0; i < 24; i++) Set.ssid2[i] = 0x00;\r\n\t\t\ttemInt = WiFi_Server.arg(n).length() + 1;\r\n\t\t\tWiFi_Server.arg(n).toCharArray(Set.ssid2, temInt);\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"Password_MY2\") {\r\n\t\t\tfor (int i = 0; i < 24; i++) Set.password2[i] = 0x00;\r\n\t\t\ttemInt = WiFi_Server.arg(n).length() + 1;\r\n\t\t\tWiFi_Server.arg(n).toCharArray(Set.password2, temInt);\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"SSID_MY3\") {\r\n\t\t\tfor (int i = 0; i < 24; i++) Set.ssid3[i] = 0x00;\r\n\t\t\ttemInt = WiFi_Server.arg(n).length() + 1;\r\n\t\t\tWiFi_Server.arg(n).toCharArray(Set.ssid3, temInt);\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"Password_MY3\") {\r\n\t\t\tfor (int i = 0; i < 24; i++) Set.password3[i] = 0x00;\r\n\t\t\ttemInt = WiFi_Server.arg(n).length() + 1;\r\n\t\t\tWiFi_Server.arg(n).toCharArray(Set.password3, temInt);\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"SSID_MY4\") {\r\n\t\t\tfor (int i = 0; i < 24; i++) Set.ssid4[i] = 0x00;\r\n\t\t\ttemInt = WiFi_Server.arg(n).length() + 1;\r\n\t\t\tWiFi_Server.arg(n).toCharArray(Set.ssid4, temInt);\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"Password_MY4\") {\r\n\t\t\tfor (int i = 0; i < 24; i++) Set.password4[i] = 0x00;\r\n\t\t\ttemInt = WiFi_Server.arg(n).length() + 1;\r\n\t\t\tWiFi_Server.arg(n).toCharArray(Set.password4, temInt);\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"SSID_MY5\") {\r\n\t\t\tfor (int i = 0; i < 24; i++) Set.ssid5[i] = 0x00;\r\n\t\t\ttemInt = WiFi_Server.arg(n).length() + 1;\r\n\t\t\tWiFi_Server.arg(n).toCharArray(Set.ssid5, temInt);\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"Password_MY5\") {\r\n\t\t\tfor (int i = 0; i < 24; i++) Set.password5[i] = 0x00;\r\n\t\t\ttemInt = WiFi_Server.arg(n).length() + 1;\r\n\t\t\tWiFi_Server.arg(n).toCharArray(Set.password5, temInt);\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"timeoutRout\") {\r\n\t\t\targVal = WiFi_Server.arg(n).toInt();\r\n\t\t\tif ((argVal >= 20) && (argVal <= 200)) { Set.timeoutRouter = byte(argVal); }\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"timeoutWebIO\") {\r\n\t\t\ttemLong = WiFi_Server.arg(n).toInt();\r\n\t\t\tif ((temLong >= 2) && (temLong <= 255)) { Set.timeoutWebIO = byte(temLong); }\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"WiFiIP0\") {\r\n\t\t\ttemInt = WiFi_Server.arg(n).toInt();\r\n\t\t\tSet.WiFi_myip[0] = byte(temInt);\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"WiFiIP1\") {\r\n\t\t\ttemInt = WiFi_Server.arg(n).toInt();\r\n\t\t\tSet.WiFi_myip[1] = byte(temInt);\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"WiFiIP2\") {\r\n\t\t\ttemInt = WiFi_Server.arg(n).toInt();\r\n\t\t\tSet.WiFi_myip[2] = byte(temInt);\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"WiFiIP3\") {\r\n\t\t\ttemInt = WiFi_Server.arg(n).toInt();\r\n\t\t\tSet.WiFi_myip[3] = byte(temInt);\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"WiFiIPDest\") {\r\n\t\t\ttemInt = WiFi_Server.arg(n).toInt();\r\n\t\t\tSet.WiFi_ipDest_ending = byte(temInt);\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"EthIP0\") {\r\n\t\t\ttemInt = WiFi_Server.arg(n).toInt();\r\n\t\t\tSet.Eth_myip[0] = byte(temInt);\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"EthIP1\") {\r\n\t\t\ttemInt = WiFi_Server.arg(n).toInt();\r\n\t\t\tSet.Eth_myip[1] = byte(temInt);\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"EthIP2\") {\r\n\t\t\ttemInt = WiFi_Server.arg(n).toInt();\r\n\t\t\tSet.Eth_myip[2] = byte(temInt);\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"EthIP3\") {\r\n\t\t\ttemInt = WiFi_Server.arg(n).toInt();\r\n\t\t\tSet.Eth_myip[3] = byte(temInt);\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"EthStatIP\") {\r\n\t\t\ttemInt = WiFi_Server.arg(n).toInt();\r\n\t\t\tif (temInt == 1) { Set.Eth_static_IP = true; }\r\n\t\t\telse { Set.Eth_static_IP = false; }\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"EthIPDest\") {\r\n\t\t\ttemInt = WiFi_Server.arg(n).toInt();\r\n\t\t\tSet.Eth_ipDest_ending = byte(temInt);\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"EthMac0\") {\r\n\t\t\ttemInt = WiFi_Server.arg(n).toInt();\r\n\t\t\tSet.Eth_mac[0] = byte(temInt);\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"EthMac1\") {\r\n\t\t\ttemInt = WiFi_Server.arg(n).toInt();\r\n\t\t\tSet.Eth_mac[1] = byte(temInt);\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"EthMac2\") {\r\n\t\t\ttemInt = WiFi_Server.arg(n).toInt();\r\n\t\t\tSet.Eth_mac[2] = byte(temInt);\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"EthMac3\") {\r\n\t\t\ttemInt = WiFi_Server.arg(n).toInt();\r\n\t\t\tSet.Eth_mac[3] = byte(temInt);\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"EthMac4\") {\r\n\t\t\ttemInt = WiFi_Server.arg(n).toInt();\r\n\t\t\tSet.Eth_mac[4] = byte(temInt);\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"EthMac5\") {\r\n\t\t\ttemInt = WiFi_Server.arg(n).toInt();\r\n\t\t\tSet.Eth_mac[5] = byte(temInt);\r\n\t\t}\r\n\r\n\t\tif (WiFi_Server.argName(n) == \"DataTransfVia\") {\r\n\t\t\ttemLong = WiFi_Server.arg(n).toInt();\r\n\t\t\tif ((temLong <= 20) && (temLong >= 0)) { Set.DataTransVia = byte(temLong); }\r\n\t\t\tif (Set.DataTransVia == 10) {\r\n\t\t\t\tif (Eth_connect_step == 255) {\r\n\t\t\t\t\tEth_connect_step = 10;\r\n\t\t\t\t\txTaskCreate(Eth_handle_connection, \"Core1EthConnectHandle\", 3072, NULL, 1, &taskHandle_Eth_connect);\r\n\t\t\t\t\tdelay(500);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (Set.DataTransVia < 5) {//USB\r\n\t\t\t\tif (!USBDataTaskRunning) {\r\n\t\t\t\t\txTaskCreate(getDataFromAOGUSB, \"DataFromAOGHandleUSB\", 5000, NULL, 1, &taskHandle_DataFromAOGUSB);\r\n\t\t\t\t\tdelay(500);\r\n\t\t\t\t}\r\n\t\t\t\tif (WiFiDataTaskRunning) { vTaskDelete(taskHandle_DataFromAOGWiFi); delay(5); WiFiDataTaskRunning = false; }\r\n\t\t\t\tif (EthDataTaskRunning) { vTaskDelete(taskHandle_DataFromAOGEth); delay(5); EthDataTaskRunning = false; }\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (Set.DataTransVia < 10) {//WiFi UDP\r\n\t\t\t\t\tif (!WiFiDataTaskRunning) {\r\n\t\t\t\t\t\txTaskCreate(getDataFromAOGWiFi, \"DataFromAOGHandleWiFi\", 5000, NULL, 1, &taskHandle_DataFromAOGWiFi);\r\n\t\t\t\t\t\tdelay(500);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (USBDataTaskRunning) { vTaskDelete(taskHandle_DataFromAOGUSB); delay(5); USBDataTaskRunning = false; }\r\n\t\t\t\t\tif (EthDataTaskRunning) { vTaskDelete(taskHandle_DataFromAOGEth); delay(5); EthDataTaskRunning = false;\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif (Set.DataTransVia == 10) {//Ethernet UDP\r\n\t\t\t\t\t\tif (!EthDataTaskRunning) {\r\n\t\t\t\t\t\t\txTaskCreate(getDataFromAOGEth, \"DataFromAOGHandleEth\", 5000, NULL, 1, &taskHandle_DataFromAOGEth);\r\n\t\t\t\t\t\tdelay(500);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (WiFiDataTaskRunning) { vTaskDelete(taskHandle_DataFromAOGWiFi); delay(5); WiFiDataTaskRunning = false;}\r\n\t\t\t\t\t\tif (USBDataTaskRunning) { vTaskDelete(taskHandle_DataFromAOGUSB); delay(5); USBDataTaskRunning = false;\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\t\t\t\r\n\t\t}\r\n\t\t\t\t\t\r\n\t\tif (WiFi_Server.argName(n) == \"aogVer\") {\r\n\t\t\targVal = WiFi_Server.arg(n).toInt();\r\n\t\t\tif ((argVal >= 0) && (argVal <= 255)) {\r\n\t\t\t\tSet.aogVersion = byte(argVal);\r\n\t\t\t\tif (Set.aogVersion == 17) {\r\n\t\t\t\t\tSCToAOG[0] = FromAOGSentenceHeader[2];\r\n\t\t\t\t\tSCToAOGOld[0] = FromAOGSentenceHeader[2];\r\n\t\t\t\t\tSCToAOG[1] = SCDataToAOGHeaderV17;\r\n\t\t\t\t\tSCToAOGOld[1] = SCDataToAOGHeaderV17;\r\n\t\t\t\t\tSCToAOG[2] = 0;\r\n\t\t\t\t\tSCToAOGOld[2] = 0;\r\n\t\t\t\t\tSCToAOG[3] = 0;\r\n\t\t\t\t\tSCToAOGOld[3] = 0;\r\n\t\t\t\t\tSCToAOG[4] = 0;\r\n\t\t\t\t\tSCToAOGOld[4] = 0;\r\n\t\t\t\t\tSCToAOG[5] = 0;\r\n\t\t\t\t\tSCToAOGOld[5] = 0;\r\n\t\t\t\t\tSCToAOG[6] = 0;\r\n\t\t\t\t\tSCToAOGOld[6] = 0;\r\n\t\t\t\t\tDataToAOGLength = SCDataSentenceToAOGLengthV17;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tSCToAOG[0] = FromAOGSentenceHeader[0];   //0x80\r\n\t\t\t\t\tSCToAOG[1] = FromAOGSentenceHeader[1];   //0x81\r\n\t\t\t\t\tSCToAOG[2] = FromSCHeader;\t\t\t\t //0x7B\r\n\t\t\t\t\tSCToAOG[3] = SCDataToAOGHeader;\t\t\t //0xEA\r\n\t\t\t\t\tSCToAOG[4] = SCDataSentenceToAOGLength - 6; //length of data = all - header - length - CRC\r\n\t\t\t\t\tSCToAOGOld[0] = FromAOGSentenceHeader[0];\r\n\t\t\t\t\tSCToAOGOld[1] = FromAOGSentenceHeader[1];\r\n\t\t\t\t\tSCToAOGOld[2] = FromSCHeader;\r\n\t\t\t\t\tSCToAOGOld[3] = SCDataToAOGHeader;\r\n\t\t\t\t\tSCToAOG[4] = SCDataSentenceToAOGLength - 6;\r\n\t\t\t\t\tDataToAOGLength = SCDataSentenceToAOGLength;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"SectNum\") {\r\n\t\t\targVal = WiFi_Server.arg(n).toInt();\r\n\t\t\tif ((argVal >= 1) && (argVal <= 100)) { Set.SectNum = byte(argVal); }\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"seRelInst\") {\r\n\t\t\tif (WiFi_Server.arg(n) == \"true\") { Set.SectRelaysInst = 1; }\r\n\t\t\telse { Set.SectRelaysInst = 0; }\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"seRelON\") {\r\n\t\t\tif (WiFi_Server.arg(n) == \"1\") { Set.SectRelaysON = 1; }\r\n\t\t\telse { Set.SectRelaysON = 0; }\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"seSWInst\") {\r\n\t\t\tif (WiFi_Server.arg(n) == \"true\") { Set.SectSWInst = 1; }\r\n\t\t\telse { Set.SectSWInst = 0; }\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"DocOnly\") {\r\n\t\t\tif (WiFi_Server.arg(n) == \"true\") { Set.DocOnly = 1; }\r\n\t\t\telse { Set.DocOnly = 0; }\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"DocSWspr\") {\r\n\t\t\tif (WiFi_Server.arg(n) == \"1\") { Set.SectSWAutoOrOn = 1; }\r\n\t\t\telse { Set.SectSWAutoOrOn = 0; }\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"RCSWInst\") {\r\n\t\t\tif (WiFi_Server.arg(n) == \"true\") { Set.RateSWLeftInst = 1; }\r\n\t\t\telse { Set.RateSWLeftInst = 0; }\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"MainSW\") {\r\n\t\t\targVal = WiFi_Server.arg(n).toInt();\r\n\t\t\tif ((argVal >= 0) && (argVal <= 6)) { Set.SectMainSWType = byte(argVal); }\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"debugmode\") {\r\n\t\t\tif (WiFi_Server.arg(n) == \"true\") { Set.debugmode = true; }\r\n\t\t\telse { Set.debugmode = false; }\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"debugmSW\") {\r\n\t\t\tif (WiFi_Server.arg(n) == \"true\") { Set.debugmodeSwitches = true; }\r\n\t\t\telse { Set.debugmodeSwitches = false; }\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"debugmRel\") {\r\n\t\t\tif (WiFi_Server.arg(n) == \"true\") { Set.debugmodeRelay = true; }\r\n\t\t\telse { Set.debugmodeRelay = false; }\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"debugmDatFromAOG\") {\r\n\t\t\tif (WiFi_Server.arg(n) == \"true\") { Set.debugmodeDataFromAOG = true; }\r\n\t\t\telse { Set.debugmodeDataFromAOG = false; }\r\n\t\t}\r\n\t\tif (WiFi_Server.argName(n) == \"debugmDatToAOG\") {\r\n\t\t\tif (WiFi_Server.arg(n) == \"true\") { Set.debugmodeDataToAOG = true; }\r\n\t\t\telse { Set.debugmodeDataToAOG = false; }\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\n\r\n//-------------------------------------------------------------------------------------------------\r\n// HTML Seite 01 aufbauen\r\n//-------------------------------------------------------------------------------------------------\r\n\r\n\r\nvoid make_HTML01() {\r\n\r\n\tstrcpy(HTML_String, \"<!DOCTYPE html>\");\r\n\tstrcat(HTML_String, \"<html>\");\r\n\tstrcat(HTML_String, \"<head>\");\r\n\tstrcat(HTML_String, \"<title>Section Control Config Page</title>\");\r\n\tstrcat(HTML_String, \"<meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1.0;\\\" />\\r\\n\");\r\n\t//strcat( HTML_String, \"<meta http-equiv=\\\"refresh\\\" content=\\\"10\\\">\");\r\n\tstrcat(HTML_String, \"<style>divbox {background-color: lightgrey;width: 200px;border: 5px solid red;padding:10px;margin: 10px;}</style>\");\r\n\tstrcat(HTML_String, \"</head>\");\r\n\tstrcat(HTML_String, \"<body bgcolor=\\\"#ccff66\\\">\");//ff9900\r\n\tstrcat(HTML_String, \"<font color=\\\"#000000\\\" face=\\\"VERDANA,ARIAL,HELVETICA\\\">\");\r\n\tstrcat(HTML_String, \"<h1>Section control setup</h1>\");\r\n\tstrcat(HTML_String, \"Section control software for AgOpenGPS running on ESP32<br>\");\r\n\tstrcat(HTML_String, \"supports data via USB / WiFi UDP / Ethernet UDP<br>\");\r\n\tstrcat(HTML_String, \"more settings like IPs, UPD ports... in setup zone of INO code<br><br>Version: \");\r\n\tstrcati(HTML_String, vers_nr);\r\n\tstrcat(HTML_String, VersionTXT);\r\n\tstrcat(HTML_String, \"<br><hr>\");\r\n\r\n\t//---------------------------------------------------------------------------------------------\r\n\t //load values of INO setup zone\r\n\tstrcat(HTML_String, \"<h2>Load default values of INO setup zone</h2>\");\r\n\tstrcat(HTML_String, \"<form>\");\r\n\tstrcat(HTML_String, \"<table>\");\r\n\tset_colgroup(270, 250, 150, 0, 0);\r\n\r\n\tstrcat(HTML_String, \"<tr>\");\r\n\tstrcat(HTML_String, \"<td colspan=\\\"2\\\">Only load default values, does NOT save them</td>\");\r\n\tstrcat(HTML_String, \"<td><input type= \\\"button\\\" onclick= \\\"sendVal('/?ACTION=\");\r\n\tstrcati(HTML_String, ACTION_LoadDefaultVal);\r\n\tstrcat(HTML_String, \"')\\\" style= \\\"width:150px\\\" value=\\\"Load default values\\\"></button></td>\");\r\n\tstrcat(HTML_String, \"</tr>\");\r\n\tstrcat(HTML_String, \"</table></form><br><hr>\");\r\n\r\n\t//-----------------------------------------------------------------------------------------\r\n// WiFi Client Access Data\r\n\r\n\tstrcat(HTML_String, \"<h2>WiFi Network Client Access Data</h2>\");\r\n\tstrcat(HTML_String, \"<b>Data to access tractor WiFi or mobil phone hotspots.<br>Connections are checked in this order.</b><br><br>\");\r\n\tstrcat(HTML_String, \"If access to networks fails, an accesspoint will be created:<br>SSID: <b>\");\r\n\tstrcat(HTML_String, Set.ssid_ap);\r\n\tstrcat(HTML_String, \"</b>     with no password<br><br><table>\");\r\n\tstrcat(HTML_String, \"<form>\");\r\n\tset_colgroup(250, 300, 150, 0, 0);\r\n\r\n\tstrcat(HTML_String, \"<tr><td><b>#1 Network SSID:</b></td>\");\r\n\tstrcat(HTML_String, \"<td><input type=\\\"text\\\" onchange=\\\"sendVal('/?SSID_MY1='+this.value)\\\" style= \\\"width:200px\\\" name=\\\"SSID_MY1\\\" maxlength=\\\"22\\\" Value =\\\"\");\r\n\tstrcat(HTML_String, Set.ssid1);\r\n\tstrcat(HTML_String, \"\\\"></td>\");\r\n\tstrcat(HTML_String, \"<td><input type= \\\"button\\\" onclick= \\\"sendVal('/?Save=true')\\\" style= \\\"width:120px\\\" value=\\\"Save\\\"></button></td></tr>\");\r\n\r\n\tstrcat(HTML_String, \"<tr><td><b>#1 Password:</b></td>\");\r\n\tstrcat(HTML_String, \"<td>\");\r\n\tstrcat(HTML_String, \"<input type=\\\"text\\\" onchange=\\\"sendVal('/?Password_MY1='+this.value)\\\" style= \\\"width:200px\\\" name=\\\"Password_MY1\\\" maxlength=\\\"22\\\" Value =\\\"\");\r\n\tstrcat(HTML_String, Set.password1);\r\n\tstrcat(HTML_String, \"\\\"></td></tr>\");\r\n\r\n\tstrcat(HTML_String, \"<tr> <td colspan=\\\"3\\\">&nbsp;</td> </tr>\");\r\n\r\n\tstrcat(HTML_String, \"<tr><td><b>#2 Network SSID:</b></td>\");\r\n\tstrcat(HTML_String, \"<td><input type=\\\"text\\\" onchange=\\\"sendVal('/?SSID_MY2='+this.value)\\\" style= \\\"width:200px\\\" name=\\\"SSID_MY2\\\" maxlength=\\\"22\\\" Value =\\\"\");\r\n\tstrcat(HTML_String, Set.ssid2);\r\n\tstrcat(HTML_String, \"\\\"></td>\");\r\n\r\n\tstrcat(HTML_String, \"<tr><td><b>#2 Password:</b></td>\");\r\n\tstrcat(HTML_String, \"<td>\");\r\n\tstrcat(HTML_String, \"<input type=\\\"text\\\" onchange=\\\"sendVal('/?Password_MY2='+this.value)\\\" style= \\\"width:200px\\\" name=\\\"Password_MY2\\\" maxlength=\\\"22\\\" Value =\\\"\");\r\n\tstrcat(HTML_String, Set.password2);\r\n\tstrcat(HTML_String, \"\\\"></td></tr>\");\r\n\r\n\tstrcat(HTML_String, \"<tr> <td colspan=\\\"3\\\">&nbsp;</td> </tr>\");\r\n\r\n\tstrcat(HTML_String, \"<tr><td><b>#3 Network SSID:</b></td>\");\r\n\tstrcat(HTML_String, \"<td><input type=\\\"text\\\" onchange=\\\"sendVal('/?SSID_MY3='+this.value)\\\" style= \\\"width:200px\\\" name=\\\"SSID_MY3\\\" maxlength=\\\"22\\\" Value =\\\"\");\r\n\tstrcat(HTML_String, Set.ssid3);\r\n\tstrcat(HTML_String, \"\\\"></td>\");\r\n\r\n\tstrcat(HTML_String, \"<tr><td><b>#3 Password:</b></td>\");\r\n\tstrcat(HTML_String, \"<td>\");\r\n\tstrcat(HTML_String, \"<input type=\\\"text\\\" onchange=\\\"sendVal('/?Password_MY3='+this.value)\\\" style= \\\"width:200px\\\" name=\\\"Password_MY3\\\" maxlength=\\\"22\\\" Value =\\\"\");\r\n\tstrcat(HTML_String, Set.password3);\r\n\tstrcat(HTML_String, \"\\\"></td></tr>\");\r\n\r\n\tstrcat(HTML_String, \"<tr> <td colspan=\\\"3\\\">&nbsp;</td> </tr>\");\r\n\r\n\tstrcat(HTML_String, \"<tr><td><b>#4 Network SSID:</b></td>\");\r\n\tstrcat(HTML_String, \"<td><input type=\\\"text\\\" onchange=\\\"sendVal('/?SSID_MY4='+this.value)\\\" style= \\\"width:200px\\\" name=\\\"SSID_MY4\\\" maxlength=\\\"22\\\" Value =\\\"\");\r\n\tstrcat(HTML_String, Set.ssid4);\r\n\tstrcat(HTML_String, \"\\\"></td>\");\r\n\r\n\tstrcat(HTML_String, \"<tr><td><b>#4 Password:</b></td>\");\r\n\tstrcat(HTML_String, \"<td>\");\r\n\tstrcat(HTML_String, \"<input type=\\\"text\\\" onchange=\\\"sendVal('/?Password_MY4='+this.value)\\\" style= \\\"width:200px\\\" name=\\\"Password_MY4\\\" maxlength=\\\"22\\\" Value =\\\"\");\r\n\tstrcat(HTML_String, Set.password4);\r\n\tstrcat(HTML_String, \"\\\"></td></tr>\");\r\n\r\n\tstrcat(HTML_String, \"<tr> <td colspan=\\\"3\\\">&nbsp;</td> </tr>\");\r\n\r\n\tstrcat(HTML_String, \"<tr><td><b>#5 Network SSID:</b></td>\");\r\n\tstrcat(HTML_String, \"<td><input type=\\\"text\\\" onchange=\\\"sendVal('/?SSID_MY5='+this.value)\\\" style= \\\"width:200px\\\" name=\\\"SSID_MY5\\\" maxlength=\\\"22\\\" Value =\\\"\");\r\n\tstrcat(HTML_String, Set.ssid5);\r\n\tstrcat(HTML_String, \"\\\"></td>\");\r\n\r\n\tstrcat(HTML_String, \"<tr><td><b>#5 Password:</b></td>\");\r\n\tstrcat(HTML_String, \"<td>\");\r\n\tstrcat(HTML_String, \"<input type=\\\"text\\\" onchange=\\\"sendVal('/?Password_MY5='+this.value)\\\" style= \\\"width:200px\\\" name=\\\"Password_MY5\\\" maxlength=\\\"22\\\" Value =\\\"\");\r\n\tstrcat(HTML_String, Set.password5);\r\n\tstrcat(HTML_String, \"\\\"></td></tr>\");\r\n\r\n\tstrcat(HTML_String, \"<tr> <td colspan=\\\"3\\\">&nbsp;</td> </tr>\");\r\n\r\n\tstrcat(HTML_String, \"<tr>\");\r\n\tstrcat(HTML_String, \"<td colspan=\\\"3\\\">time, trying to connect to networks from list above</td></tr>\");\r\n\tstrcat(HTML_String, \"<td colspan=\\\"3\\\">after time has passed, access point is opened: <b>\");\r\n\tstrcat(HTML_String, Set.ssid_ap);\r\n\tstrcat(HTML_String, \"</b> with no password</td></tr>\");\r\n\tstrcat(HTML_String, \"<tr><td><b>Timeout (s):</b></td><td><input type = \\\"number\\\" onchange=\\\"sendVal('/?timeoutRout='+this.value)\\\" name = \\\"timeoutRout\\\" min = \\\"20\\\" max = \\\"1000\\\" step = \\\"1\\\" style= \\\"width:200px\\\" value = \\\"\");// placeholder = \\\"\");\r\n\tstrcati(HTML_String, Set.timeoutRouter);\r\n\tstrcat(HTML_String, \"\\\"></td>\");\r\n\tstrcat(HTML_String, \"<td><input type= \\\"button\\\" onclick= \\\"sendVal('/?Save=true')\\\" style= \\\"width:120px\\\" value=\\\"Save\\\"></button></td>\");\r\n\tstrcat(HTML_String, \"</tr>\");\r\n\r\n\tstrcat(HTML_String, \"<tr> <td colspan=\\\"3\\\">&nbsp;</td> </tr>\");\r\n\tstrcat(HTML_String, \"<tr><td colspan=\\\"2\\\"><b>Restart section control unit</b></td>\");\r\n\tstrcat(HTML_String, \"<td><input type= \\\"button\\\" onclick= \\\"sendVal('/?ACTION=\");\r\n\tstrcati(HTML_String, ACTION_RESTART);\r\n\tstrcat(HTML_String, \"')\\\" style= \\\"width:120px\\\" value=\\\"Restart\\\"></button></td>\");\r\n\tstrcat(HTML_String, \"</tr>\");\r\n\r\n\tstrcat(HTML_String, \"</table>\");\r\n\tstrcat(HTML_String, \"</form>\");\r\n\tstrcat(HTML_String, \"<br><hr>\");\r\n\r\n\t//-----------------------------------------------------------------------------------------\r\n\t// timeout webinterface\r\n\r\n\tstrcat(HTML_String, \"<h2>Webinterface timeout</h2>\");\r\n\tstrcat(HTML_String, \"<form>\");\r\n\tstrcat(HTML_String, \"<b>Webinterface needs lots of calculation time, so if switched off, GPS runs better.</b><br>\");\r\n\tstrcat(HTML_String, \"After this time (minutes) from restart, or last usage, webinterface is turned off.<br><br>\");\r\n\tstrcat(HTML_String, \"Set to 255 to keep active.<br><br><table>\");\r\n\tset_colgroup(250, 300, 150, 0, 0);\r\n\r\n\tstrcat(HTML_String, \"<tr><td><b>Webinterface timeout (min)</b></td><td><input type = \\\"number\\\"  onchange=\\\"sendVal('/?timeoutWebIO='+this.value)\\\" name = \\\"timeoutWebIO\\\" min = \\\"2\\\" max = \\\"255\\\" step = \\\"1\\\" style= \\\"width:200px\\\" value = \\\"\");// placeholder = \\\"\");\r\n\tstrcati(HTML_String, Set.timeoutWebIO);\r\n\tstrcat(HTML_String, \"\\\"></td>\");\r\n\r\n\tstrcat(HTML_String, \"<td><input type= \\\"button\\\" onclick= \\\"sendVal('/?Save=true')\\\" style= \\\"width:120px\\\" value=\\\"Save\\\"></button></td>\");\r\n\tstrcat(HTML_String, \"</tr>\");\r\n\r\n\r\n\tstrcat(HTML_String, \"</table>\");\r\n\tstrcat(HTML_String, \"</form>\");\r\n\tstrcat(HTML_String, \"<br><hr>\");\r\n\r\n\t//---------------------------------------------------------------------------------------------  \r\n\t// Data transfer via USB/Wifi \r\n\tstrcat(HTML_String, \"<h2>USB, WiFi or Ethernet data transfer</h2>\");\r\n\tstrcat(HTML_String, \"<form>\");\r\n\tstrcat(HTML_String, \"<table>\");\r\n\tset_colgroup(150, 400, 150, 0, 0);\r\n\r\n\t//transfer data via 0 = USB / 7 = WiFi UDP / 10 = Ethernet\r\n\tstrcat(HTML_String, \"<tr>\");\r\n\tstrcat(HTML_String, \"<td></td><td><input type = \\\"radio\\\" onclick=\\\"sendVal('/?DataTransfVia=0')\\\" name=\\\"DataTransfVia\\\" id=\\\"JZ\\\" value=\\\"0\\\"\");\r\n\tif (Set.DataTransVia == 0)strcat(HTML_String, \" CHECKED\");\r\n\tstrcat(HTML_String, \"><label for=\\\"JZ\\\">USB</label></td>\");\r\n\tstrcat(HTML_String, \"<td><input type= \\\"button\\\" onclick= \\\"sendVal('/?Save=true')\\\" style= \\\"width:120px\\\" value=\\\"Save\\\"></button></td>\");\r\n\tstrcat(HTML_String, \"</tr>\");\r\n\r\n\tstrcat(HTML_String, \"<tr>\");\r\n\tstrcat(HTML_String, \"<td></td><td><input type = \\\"radio\\\" onclick=\\\"sendVal('/?DataTransfVia=7')\\\" name=\\\"DataTransfVia\\\" id=\\\"JZ\\\" value=\\\"7\\\"\");\r\n\tif (Set.DataTransVia == 7)strcat(HTML_String, \" CHECKED\");\r\n\tstrcat(HTML_String, \"><label for=\\\"JZ\\\">WiFi (UDP) (default)</label></td></tr>\");\r\n\r\n  strcat(HTML_String, \"<tr>\");\r\n  strcat(HTML_String, \"<td></td><td colspan=\\\"2\\\"><input type = \\\"radio\\\" onclick=\\\"sendVal('/?DataTransfVia=10')\\\" name=\\\"DataTransfVia\\\" id=\\\"JZ\\\" value=\\\"10\\\"\");\r\n  if (Set.DataTransVia == 10)strcat(HTML_String, \" CHECKED\");\r\n  strcat(HTML_String, \"><label for=\\\"JZ\\\">Ethernet (UDP) Ethernet hardware needed!!</label></td></tr>\");\r\n\r\n  strcat(HTML_String, \"<tr>\");\r\n  strcat(HTML_String, \"<td></td><td colspan=\\\"2\\\"><input type = \\\"radio\\\" onclick=\\\"sendVal('/?DataTransfVia=9')\\\" name=\\\"DataTransfVia\\\" id=\\\"JZ\\\" value=\\\"10\\\"\");\r\n  if (Set.DataTransVia == 9)strcat(HTML_String, \" CHECKED\");\r\n  strcat(HTML_String, \"><label for=\\\"JZ\\\">Ethernet (UDP) WT32_Eth01 hardware needed!!</label></td></tr>\");\r\n\tstrcat(HTML_String, \"</table>\");\r\n\tstrcat(HTML_String, \"</form><br><hr>\");\r\n\r\n\t//-----------------------------------------------------------------------------------------\r\n    // AOG Version\r\n\r\n\tstrcat(HTML_String, \"<h2>AOG Version number</h2>\");\r\n\tstrcat(HTML_String, \"<form>\");\r\n\tstrcat(HTML_String, \"<b>For AgOpenGPS version 4.3 and below set 17, for V 4.6 and above set 20</b><br>\");\r\n\tstrcat(HTML_String, \"AOG 4.3.10 = 4 + 3 + 10 = 17<br><br><table>\");\r\n\tset_colgroup(250, 300, 150, 0, 0);\r\n\r\n\tstrcat(HTML_String, \"<tr><td><b>AOG Version code</b></td><td><input type = \\\"number\\\"  onchange=\\\"sendVal('/?aogVer='+this.value)\\\" name = \\\"aogVer\\\" min = \\\"0\\\" max = \\\"255\\\" step = \\\"1\\\" style= \\\"width:200px\\\" value = \\\"\");// placeholder = \\\"\");\r\n\tstrcati(HTML_String, Set.aogVersion);\r\n\tstrcat(HTML_String, \"\\\"></td>\");\r\n\r\n\tstrcat(HTML_String, \"<td><input type= \\\"button\\\" onclick= \\\"sendVal('/?Save=true')\\\" style= \\\"width:120px\\\" value=\\\"Save\\\"></button></td>\");\r\n\tstrcat(HTML_String, \"</tr>\");\r\n\r\n\r\n\tstrcat(HTML_String, \"</table>\");\r\n\tstrcat(HTML_String, \"</form><br><hr>\");\r\n\r\n\r\n\t/*   //---------------------------------------------------------------------------------------------\r\n\t   // WiFi LED light on high/low\r\n\t   strcat(HTML_String, \"<h2>WiFi LED light on</h2>\");\r\n\t   strcat(HTML_String, \"<form>\");\r\n\t   strcat(HTML_String, \"<table>\");\r\n\t   set_colgroup(150, 270, 150, 0, 0);\r\n\r\n\t   strcat(HTML_String, \"<tr>\");\r\n\t   strcat(HTML_String, \"<td></td><td><input type = \\\"radio\\\" name=\\\"WiFiLEDon\\\" id=\\\"JZ\\\" value=\\\"0\\\"\");\r\n\t   if (Set.LEDWiFi_ON_Level == 0)strcat(HTML_String, \" CHECKED\");\r\n\t   strcat(HTML_String, \"><label for=\\\"JZ\\\">LOW</label></td>\");\r\n\t   strcat(HTML_String, \"<td><button style= \\\"width:120px\\\" name=\\\"ACTION\\\" value=\\\"\");\r\n\t   strcati(HTML_String, ACTION_SET_WiFiLEDon);\r\n\t   strcat(HTML_String, \"\\\">Apply and Save</button></td>\");\r\n\t   strcat(HTML_String, \"</tr>\");\r\n\r\n\t   strcat(HTML_String, \"<tr>\");\r\n\t   strcat(HTML_String, \"<td></td><td><input type = \\\"radio\\\" name=\\\"WiFiLEDon\\\" id=\\\"JZ\\\" value=\\\"1\\\"\");\r\n\t   if (Set.LEDWiFi_ON_Level == 1)strcat(HTML_String, \" CHECKED\");\r\n\t   strcat(HTML_String, \"><label for=\\\"JZ\\\">HIGH</label></td></tr>\");\r\n\r\n\t   strcat(HTML_String, \"</table>\");\r\n\t   strcat(HTML_String, \"</form>\");\r\n\t   strcat(HTML_String, \"<br><hr>\");\r\n\t   */\r\n\r\n\t//---------------------------------------------------------------------------------------------  \r\n\t// Number of sections\r\n\r\n\tstrcat(HTML_String, \"<h2>Number of sections</h2>\");\r\n\r\n\tstrcat(HTML_String, \"<form>\");\r\n\tstrcat(HTML_String, \"<table>\");\r\n\tset_colgroup(250, 300, 150, 0, 0);\r\n\r\n\tstrcat(HTML_String, \"<tr>\");\r\n\tstrcat(HTML_String, \"<td colspan=\\\"3\\\">Set number of sections (1-16).</td></tr>\");\r\n\tstrcat(HTML_String, \"<tr><td><b>number of sections</b></td><td><input type = \\\"number\\\"  onchange=\\\"sendVal('/?SectNum='+this.value)\\\" name = \\\"SectNum\\\" min = \\\"1\\\" max = \\\"100\\\" step = \\\"1\\\" style= \\\"width:200px\\\" value = \\\"\");\r\n\tstrcati(HTML_String, Set.SectNum);\r\n\tstrcat(HTML_String, \"\\\"></td>\");\r\n\r\n\tstrcat(HTML_String, \"<td><input type= \\\"button\\\" onclick= \\\"sendVal('/?Save=true')\\\" style= \\\"width:120px\\\" value=\\\"Save\\\"></button></td>\");\r\n\tstrcat(HTML_String, \"</tr>\");\r\n\r\n\tstrcat(HTML_String, \"</table></form><br><hr>\");\r\n\r\n\r\n\t//---------------------------------------------------------------------------------------------\r\n\t// Checkboxes IO functions\r\n\tstrcat(HTML_String, \"<h2>Section control uses</h2>\");\r\n\tstrcat(HTML_String, \"<form>\");\r\n\tstrcat(HTML_String, \"<table>\");\r\n\tset_colgroup(150, 250, 150, 145, 150);\r\n\r\n\t//relais\r\n\tstrcat(HTML_String, \"<tr>\");\r\n\tstrcat(HTML_String, \"<td colspan=\\\"2\\\"><b>Relay output</b></td><td colspan=\\\"2\\\"><input type=\\\"checkbox\\\" onclick=\\\"sendVal('/?seRelInst='+this.checked)\\\" name=\\\"seRelInst\\\" id = \\\"Part\\\" value = \\\"1\\\" \");\r\n\tif (Set.SectRelaysInst == 1) strcat(HTML_String, \"checked \");\r\n\tstrcat(HTML_String, \"> \");\r\n\tstrcat(HTML_String, \"<label for =\\\"Part\\\"> installed</label>\");\r\n\tstrcat(HTML_String, \"</td>\");\r\n\tstrcat(HTML_String, \"<td><input type= \\\"button\\\" onclick= \\\"sendVal('/?Save=true')\\\" style= \\\"width:120px\\\" value=\\\"Save\\\"></button></td>\");\r\n\r\n\tstrcat(HTML_String, \"<tr>\");\r\n\tstrcat(HTML_String, \"<td></td><td>if installed</td><td><input type = \\\"radio\\\" onclick=\\\"sendVal('/?seRelON=0')\\\" name=\\\"seRelON\\\" id=\\\"JZ\\\" value=\\\"0\\\"\");\r\n\tif (Set.SectRelaysON == 0)strcat(HTML_String, \" CHECKED\");\r\n\tstrcat(HTML_String, \"><label for=\\\"JZ\\\"> LOW</label></td>\");\r\n\tstrcat(HTML_String, \"</tr>\");\r\n\r\n\tstrcat(HTML_String, \"<td></td><td>relays spray on</td><td><input type = \\\"radio\\\" onclick=\\\"sendVal('/?seRelON=1')\\\" name=\\\"seRelON\\\" id=\\\"JZ\\\" value=\\\"1\\\"\");\r\n\tif (Set.SectRelaysON == 1)strcat(HTML_String, \" CHECKED\");\r\n\tstrcat(HTML_String, \"><label for=\\\"JZ\\\"> HIGH</label></td>\");\r\n\tstrcat(HTML_String, \"</tr>\");\r\n\r\n\tstrcat(HTML_String, \"<tr> <td colspan=\\\"3\\\">&nbsp;</td> </tr>\");\r\n\r\n\t//switches\r\n\tstrcat(HTML_String, \"<tr>\");\r\n\tstrcat(HTML_String, \"<td colspan=\\\"2\\\"><b>Switches for sections</b></td><td colspan=\\\"2\\\"><input type=\\\"checkbox\\\" onclick=\\\"sendVal('/?seSWInst='+this.checked)\\\" name=\\\"seSWInst\\\" id = \\\"Part\\\" value = \\\"1\\\" \");\r\n\tif (Set.SectSWInst == 1) strcat(HTML_String, \"checked \");\r\n\tstrcat(HTML_String, \"> \");\r\n\tstrcat(HTML_String, \"<label for =\\\"Part\\\"> installed</label>\");\r\n\tstrcat(HTML_String, \"</td>\");\r\n\tstrcat(HTML_String, \"<td><input type= \\\"button\\\" onclick= \\\"sendVal('/?Save=true')\\\" style= \\\"width:120px\\\" value=\\\"Save\\\"></button></td>\");\r\n\r\n\tstrcat(HTML_String, \"<tr>\");\r\n\tstrcat(HTML_String, \"<td></td><td>if installed</td><td><input type = \\\"radio\\\" onclick=\\\"sendVal('/?DocSWspr=0')\\\" name=\\\"DocSWspr\\\" id=\\\"JZ\\\" value=\\\"0\\\"\");\r\n\tif (Set.SectSWAutoOrOn == 0)strcat(HTML_String, \" CHECKED\");\r\n\tstrcat(HTML_String, \"><label for=\\\"JZ\\\"> LOW</label></td>\");\r\n\tstrcat(HTML_String, \"</tr>\");\r\n\r\n\tstrcat(HTML_String, \"<td></td><td>switches spray on</td><td><input type = \\\"radio\\\" onclick=\\\"sendVal('/?DocSWspr=1')\\\" name=\\\"DocSWspr\\\" id=\\\"JZ\\\" value=\\\"1\\\"\");\r\n\tif (Set.SectSWAutoOrOn == 1)strcat(HTML_String, \" CHECKED\");\r\n\tstrcat(HTML_String, \"><label for=\\\"JZ\\\"> HIGH</label></td>\");\r\n\tstrcat(HTML_String, \"</tr>\");\r\n\r\n\tstrcat(HTML_String, \"<tr> <td colspan=\\\"3\\\">&nbsp;</td> </tr>\");\r\n\r\n\tstrcat(HTML_String, \"<tr><td colspan=\\\"4\\\"><b>Use as section control, or documentation<br>doc = AgOpenGPS writes status of input switches.</b></td></tr>\");\r\n\tstrcat(HTML_String, \"<tr>\");\r\n\tstrcat(HTML_String, \"<td colspan=\\\"2\\\"></td><td colspan=\\\"2\\\"><input type=\\\"checkbox\\\" onclick=\\\"sendVal('/?DocOnly='+this.checked)\\\" name=\\\"DocOnly\\\" id = \\\"Part\\\" value = \\\"1\\\" \");\r\n\tif (Set.DocOnly == 1) strcat(HTML_String, \"checked \");\r\n\tstrcat(HTML_String, \"> \");\r\n\tstrcat(HTML_String, \"<label for =\\\"Part\\\"> Documentation only</label>\");\r\n\tstrcat(HTML_String, \"</td></tr>\");\r\n\r\n\tstrcat(HTML_String, \"<tr> <td colspan=\\\"3\\\">&nbsp;</td> </tr>\");\r\n\r\n\r\n\t//rate SW\r\n\tstrcat(HTML_String, \"<tr>\");\r\n\tstrcat(HTML_String, \"<td colspan=\\\"4\\\"><b>Rate Control Switch only for +/- Motor valve</b></td>\");\r\n\tstrcat(HTML_String, \"<tr><td colspan=\\\"2\\\"></td><td><input type = \\\"checkbox\\\" onclick=\\\"sendVal('/?RCSWInst='+this.checked)\\\" name=\\\"RCSWInst\\\" id = \\\"RCS\\\" value = \\\"1\\\" \");\r\n\tif (Set.RateSWLeftInst == 1) strcat(HTML_String, \"checked \");\r\n\tstrcat(HTML_String, \"> \");\r\n\tstrcat(HTML_String, \"<label for =\\\"RCS\\\"> installed</label>\");\r\n\tstrcat(HTML_String, \"</td>\");\r\n\tstrcat(HTML_String, \"<td></td><td><input type= \\\"button\\\" onclick= \\\"sendVal('/?Save=true')\\\" style= \\\"width:120px\\\" value=\\\"Save\\\"></button></td>\");\r\n\r\n\tstrcat(HTML_String, \"<tr> <td colspan=\\\"3\\\">&nbsp;</td> </tr>\");\r\n\r\n\t//main SW\r\n\tstrcat(HTML_String, \"<tr><td colspan=\\\"4\\\"><b>Main switch for section control</b></td>\");\r\n\tstrcat(HTML_String, \"<tr>\");\r\n\tstrcat(HTML_String, \"<td></td><td colspan=\\\"3\\\"><input type = \\\"radio\\\" onclick=\\\"sendVal('/?MainSW=0')\\\" name=\\\"MainSW\\\" id=\\\"MS\\\" value=\\\"0\\\"\");\r\n\tif (Set.SectMainSWType == 0)strcat(HTML_String, \" CHECKED\");\r\n\tstrcat(HTML_String, \"><label for=\\\"MS\\\"> none</label></td>\");\r\n\tstrcat(HTML_String, \"<td><input type= \\\"button\\\" onclick= \\\"sendVal('/?Save=true')\\\" style= \\\"width:120px\\\" value=\\\"Save\\\"></button></td>\");\r\n\tstrcat(HTML_String, \"</tr>\");\r\n\r\n\tstrcat(HTML_String, \"<tr>\");\r\n\tstrcat(HTML_String, \"<td></td><td colspan=\\\"3\\\"><input type = \\\"radio\\\" onclick=\\\"sendVal('/?MainSW=1')\\\" name=\\\"MainSW\\\" id=\\\"MS\\\" value=\\\"1\\\"\");\r\n\tif (Set.SectMainSWType == 1)strcat(HTML_String, \" CHECKED\");\r\n\tstrcat(HTML_String, \"><label for=\\\"MS\\\"> (ON)-OFF-(ON) toggle switch or push buttons</label></td></tr>\");\r\n\r\n\tstrcat(HTML_String, \"<tr>\");\r\n\tstrcat(HTML_String, \"<td></td><td colspan=\\\"3\\\"><input type = \\\"radio\\\" onclick=\\\"sendVal('/?MainSW=2')\\\" name=\\\"MainSW\\\" id=\\\"MS\\\" value=\\\"2\\\"\");\r\n\tif (Set.SectMainSWType == 2)strcat(HTML_String, \" CHECKED\");\r\n\tstrcat(HTML_String, \"><label for=\\\"MS\\\"> connected to hitch level sensor</label></td></tr>\");\r\n\r\n  strcat(HTML_String, \"<tr>\");\r\n  strcat(HTML_String, \"<td></td><td colspan=\\\"3\\\"><input type = \\\"radio\\\" onclick=\\\"sendVal('/?MainSW=3')\\\" name=\\\"MainSW\\\" id=\\\"MS\\\" value=\\\"3\\\"\");\r\n  if (Set.SectMainSWType == 3)strcat(HTML_String, \" CHECKED\");\r\n  strcat(HTML_String, \"><label for=\\\"MS\\\"> inverted hitch level sensor</label></td></tr>\");\r\n\r\n  strcat(HTML_String, \"<tr>\");\r\n  strcat(HTML_String, \"<td></td><td colspan=\\\"3\\\"><input type = \\\"radio\\\" onclick=\\\"sendVal('/?MainSW=4')\\\" name=\\\"MainSW\\\" id=\\\"MS\\\" value=\\\"3\\\"\");\r\n  if (Set.SectMainSWType == 4)strcat(HTML_String, \" CHECKED\");\r\n  strcat(HTML_String, \"><label for=\\\"MS\\\"> toggle switch or button (2 separate pins)</label></td></tr>\");\r\n\r\n  strcat(HTML_String, \"<tr>\");\r\n  strcat(HTML_String, \"<td></td><td colspan=\\\"3\\\"><input type = \\\"radio\\\" onclick=\\\"sendVal('/?MainSW=5')\\\" name=\\\"MainSW\\\" id=\\\"MS\\\" value=\\\"3\\\"\");\r\n  if (Set.SectMainSWType == 5)strcat(HTML_String, \" CHECKED\");\r\n  strcat(HTML_String, \"><label for=\\\"MS\\\"> permanant switch </label></td></tr>\");\r\n\r\n  strcat(HTML_String, \"<tr>\");\r\n  strcat(HTML_String, \"<td></td><td colspan=\\\"3\\\"><input type = \\\"radio\\\" onclick=\\\"sendVal('/?MainSW=6')\\\" name=\\\"MainSW\\\" id=\\\"MS\\\" value=\\\"3\\\"\");\r\n  if (Set.SectMainSWType == 6)strcat(HTML_String, \" CHECKED\");\r\n  strcat(HTML_String, \"><label for=\\\"MS\\\"> permanant switch  inverted </label></td></tr>\");\r\n\r\n\tstrcat(HTML_String, \"<tr> <td colspan=\\\"3\\\">&nbsp;</td> </tr>\");\r\n\r\n\t//analog MAIN SW from hitch level\r\n\tif (Set.SectMainSWType > 1) {\r\n\t\tstrcat(HTML_String, \"<tr>\");\r\n\t\tstrcat(HTML_String, \"<td colspan=\\\"4\\\"><br>Analog Main Section control Threshold value</td></tr>\");\r\n\t\tstrcat(HTML_String, \"<tr> <td colspan=\\\"3\\\">&nbsp;</td> </tr>\");\r\n\r\n\t\tstrcat(HTML_String, \"<tr><td></td><td><divbox align=\\\"right\\\"><font size=\\\"+2\\\"><b>\");\r\n\t\tstrcati(HTML_String, (Set.HitchLevelVal));\r\n\t\tstrcat(HTML_String, \"</b></font></divbox></td><td colspan=\\\"2\\\">0-4095</td>\");\r\n\t\t//Refresh button\r\n\t\tstrcat(HTML_String, \"<td><input type= \\\"button\\\" onclick= \\\"location.reload()\\\" style= \\\"width:120px\\\" value=\\\"Refresh\\\"></button></td>\");\r\n\t\tstrcat(HTML_String, \"</tr>\");\r\n\r\n\t\tstrcat(HTML_String, \"<tr> <td colspan=\\\"3\\\">&nbsp;</td> </tr>\");\r\n\t\t//set treshold\r\n\t\tstrcat(HTML_String, \"<tr><td></td><td><input type= \\\"button\\\" onclick= \\\"sendVal('/?ACTION=\");\r\n\t\tstrcati(HTML_String, ACTION_SET_WS_THRESHOLD);\r\n\t\tstrcat(HTML_String, \"')\\\" style= \\\"width:200px\\\" value=\\\"Use Current\\\"></button></td></tr>\");\r\n\t\tstrcat(HTML_String, \"<tr><td colspan=\\\"4\\\"><b>Put your tool in the middle between ON and OFF position.</b></td>\");\r\n\t}\r\n\r\n\tstrcat(HTML_String, \"</table></form><br><hr>\");\r\n\r\n\t//---------------------------------------------------------------------------------------------  \r\n\t// WiFi IP settings \r\n\tstrcat(HTML_String, \"<h2>WiFi IP settings</h2>\");\r\n\tstrcat(HTML_String, \"<form>\");\r\n\t//IP\r\n\tstrcat(HTML_String, \"<b>IP address for WiFi</b><br>When using DHCP the last number is set as IP from here, the first 3 numbers are set by DHCP.<br>\");\r\n\tstrcat(HTML_String, \"<b>Default for last number is 71, it's also the address of the Webinterface.</b>\");\r\n\tstrcat(HTML_String, \"<table>\");\r\n\tset_colgroup(150, 50, 50, 50, 50);\r\n\tstrcat(HTML_String, \"<tr><td>IP address</td><td><input type = \\\"number\\\"  onchange=\\\"sendVal('/?WiFiIP0='+this.value)\\\" name = \\\"WiFiIP\\\" min = \\\"0\\\" max = \\\"255\\\" step = \\\"1\\\" style= \\\"width:40px\\\" value = \\\"\");\r\n\tstrcati(HTML_String, Set.WiFi_myip[0]);\r\n\tstrcat(HTML_String, \"\\\"></td>\");\r\n\tstrcat(HTML_String, \"<td><input type = \\\"number\\\"  onchange=\\\"sendVal('/?WiFiIP1='+this.value)\\\" name = \\\"WiFiIP\\\" min = \\\"0\\\" max = \\\"255\\\" step = \\\"1\\\" style= \\\"width:40px\\\" value = \\\"\");\r\n\tstrcati(HTML_String, Set.WiFi_myip[1]);\r\n\tstrcat(HTML_String, \"\\\"></td>\");\r\n\tstrcat(HTML_String, \"<td><input type = \\\"number\\\"  onchange=\\\"sendVal('/?WiFiIP2='+this.value)\\\" name = \\\"WiFiIP\\\" min = \\\"0\\\" max = \\\"255\\\" step = \\\"1\\\" style= \\\"width:40px\\\" value = \\\"\");\r\n\tstrcati(HTML_String, Set.WiFi_myip[2]);\r\n\tstrcat(HTML_String, \"\\\"></td>\");\r\n\tstrcat(HTML_String, \"<td><input type = \\\"number\\\"  onchange=\\\"sendVal('/?WiFiIP3='+this.value)\\\" name = \\\"WiFiIP\\\" min = \\\"0\\\" max = \\\"255\\\" step = \\\"1\\\" style= \\\"width:40px\\\" value = \\\"\");\r\n\tstrcati(HTML_String, Set.WiFi_myip[3]);\r\n\tstrcat(HTML_String, \"\\\"></td></table><br>\");\r\n\r\n\t//IP destination    \r\n\tstrcat(HTML_String, \"<table>\");\r\n\tset_colgroup(250, 300, 150, 0, 0);\r\n\tstrcat(HTML_String, \"<tr><td colspan=\\\"2\\\"><b>IP address of destination</b></td>\");\r\n\tstrcat(HTML_String, \"<td><input type= \\\"button\\\" onclick= \\\"sendVal('/?Save=true')\\\" style= \\\"width:120px\\\" value=\\\"Save\\\"></button></td>\");\r\n\tstrcat(HTML_String, \"</tr></table><table>\");\r\n\tstrcat(HTML_String, \"Destination's IP address, the first 3 numbers are set by DHCP, or as above.<br>\");\r\n\tstrcat(HTML_String, \"<b>Use 255 to send to every device in network (default).</b> Use IP of your Computer, if you don't have a router and fixed IPs\");\r\n\tstrcat(HTML_String, \"<table>\");\r\n\tset_colgroup(150, 50, 50, 50, 50);\r\n\tstrcat(HTML_String, \"<tr><td>IP address destination</td><td>xxx</td><td>xxx</td><td>xxx<td><input type = \\\"number\\\"  onchange=\\\"sendVal('/?WiFiIPDest='+this.value)\\\" name = \\\"WiFiIPDest\\\" min = \\\"0\\\" max = \\\"255\\\" step = \\\"1\\\" style= \\\"width:40px\\\" value = \\\"\");\r\n\tstrcati(HTML_String, Set.WiFi_ipDest_ending);\r\n\tstrcat(HTML_String, \"\\\"></td></table><br><hr>\");\r\n\r\n\t//---------------------------------------------------------------------------------------------  \r\n\t// Ethernet settings \r\n\tstrcat(HTML_String, \"<h2>Ethernet settings</h2>\");\r\n\tstrcat(HTML_String, \"<form>\");\r\n\tstrcat(HTML_String, \"<table>\");\r\n\tset_colgroup(150, 400, 150, 0, 0);\r\n\r\n\t//use DHCP/static IP radio button\r\n\tstrcat(HTML_String, \"<tr>\");\r\n\tstrcat(HTML_String, \"<td></td><td><input type = \\\"radio\\\" onclick=\\\"sendVal('/?EthStatIP=0')\\\" name=\\\"EthStatIP\\\" id=\\\"JZ\\\" value=\\\"0\\\"\");\r\n\tif (Set.Eth_static_IP == false)strcat(HTML_String, \" CHECKED\");\r\n\tstrcat(HTML_String, \"><label for=\\\"JZ\\\">use DHCP (default)</label></td>\");\r\n\tstrcat(HTML_String, \"<td><input type= \\\"button\\\" onclick= \\\"sendVal('/?Save=true')\\\" style= \\\"width:120px\\\" value=\\\"Save\\\"></button></td>\");\r\n\tstrcat(HTML_String, \"</tr>\");\r\n\r\n\tstrcat(HTML_String, \"<tr>\");\r\n\tstrcat(HTML_String, \"<td></td><td><input type = \\\"radio\\\" onclick=\\\"sendVal('/?EthStatIP=1')\\\" name=\\\"EthStatIP\\\" id=\\\"JZ\\\" value=\\\"1\\\"\");\r\n\tif (Set.Eth_static_IP == true)strcat(HTML_String, \" CHECKED\");\r\n\tstrcat(HTML_String, \"><label for=\\\"JZ\\\">use fixed IP from below</label></td></tr>\");\r\n\r\n\tstrcat(HTML_String, \"</table><br>\");\r\n\r\n\t//IP\r\n\tstrcat(HTML_String, \"<b>IP address for Ethernet</b><br>When using DHCP the last number is set as IP from here, the first 3 numbers are set by DHCP.<br>\");\r\n\tstrcat(HTML_String, \"<b>Default for last number is 72.</b>\");\r\n\tstrcat(HTML_String, \"<table>\");\r\n\tset_colgroup(150, 50, 50, 50, 50);\r\n\tstrcat(HTML_String, \"<tr><td>IP address</td><td><input type = \\\"number\\\"  onchange=\\\"sendVal('/?EthIP0='+this.value)\\\" name = \\\"EthIP\\\" min = \\\"0\\\" max = \\\"255\\\" step = \\\"1\\\" style= \\\"width:40px\\\" value = \\\"\");\r\n\tstrcati(HTML_String, Set.Eth_myip[0]);\r\n\tstrcat(HTML_String, \"\\\"></td>\");\r\n\tstrcat(HTML_String, \"<td><input type = \\\"number\\\"  onchange=\\\"sendVal('/?EthIP1='+this.value)\\\" name = \\\"EthIP\\\" min = \\\"0\\\" max = \\\"255\\\" step = \\\"1\\\" style= \\\"width:40px\\\" value = \\\"\");\r\n\tstrcati(HTML_String, Set.Eth_myip[1]);\r\n\tstrcat(HTML_String, \"\\\"></td>\");\r\n\tstrcat(HTML_String, \"<td><input type = \\\"number\\\"  onchange=\\\"sendVal('/?EthIP2='+this.value)\\\" name = \\\"EthIP\\\" min = \\\"0\\\" max = \\\"255\\\" step = \\\"1\\\" style= \\\"width:40px\\\" value = \\\"\");\r\n\tstrcati(HTML_String, Set.Eth_myip[2]);\r\n\tstrcat(HTML_String, \"\\\"></td>\");\r\n\tstrcat(HTML_String, \"<td><input type = \\\"number\\\"  onchange=\\\"sendVal('/?EthIP3='+this.value)\\\" name = \\\"EthIP\\\" min = \\\"0\\\" max = \\\"255\\\" step = \\\"1\\\" style= \\\"width:40px\\\" value = \\\"\");\r\n\tstrcati(HTML_String, Set.Eth_myip[3]);\r\n\tstrcat(HTML_String, \"\\\"></td></table><br>\");\r\n\r\n\t//IP destination\r\n\tstrcat(HTML_String, \"<table>\");\r\n\tset_colgroup(250, 300, 150, 0, 0);\r\n\tstrcat(HTML_String, \"<tr><td colspan=\\\"2\\\"><b>IP address of destination</b></td>\");\r\n\tstrcat(HTML_String, \"<td><input type= \\\"button\\\" onclick= \\\"sendVal('/?Save=true')\\\" style= \\\"width:120px\\\" value=\\\"Save\\\"></button></td>\");\r\n\tstrcat(HTML_String, \"</tr></table><table>\");\r\n\tstrcat(HTML_String, \"Destination's IP address, the first 3 numbers are set by DHCP, or as above.<br>\");\r\n\tstrcat(HTML_String, \"<b>Use 255 to send to every device in network (default).</b> Use IP of your Computer, if you don't have a router and fixed IPs\");\r\n\tstrcat(HTML_String, \"<table>\");\r\n\tset_colgroup(150, 50, 50, 50, 50);\r\n\tstrcat(HTML_String, \"<tr><td>IP address destination</td><td>xxx</td><td>xxx</td><td>xxx<td><input type = \\\"number\\\"  onchange=\\\"sendVal('/?EthIPDest='+this.value)\\\" name = \\\"EthIPDest\\\" min = \\\"0\\\" max = \\\"255\\\" step = \\\"1\\\" style= \\\"width:40px\\\" value = \\\"\");\r\n\tstrcati(HTML_String, Set.Eth_ipDest_ending);\r\n\tstrcat(HTML_String, \"\\\"></td></table><br>\");\r\n\r\n\t//mac\r\n\tstrcat(HTML_String, \"<b>mac address of Ethernet hardware</b><br>Type in the mac address of you Ethernet shield.<br>\");\r\n\tstrcat(HTML_String, \"<table>\");\r\n\tset_colgroup(150, 50, 50, 50, 50, 50, 50);\r\n\tstrcat(HTML_String, \"<tr><td>mac address</td><td><input type = \\\"number\\\"  onchange=\\\"sendVal('/?EthMac0='+this.value)\\\" name = \\\"EthMac\\\" min = \\\"0\\\" max = \\\"255\\\" step = \\\"1\\\" style= \\\"width:40px\\\" value = \\\"\");\r\n\tstrcati(HTML_String, Set.Eth_mac[0]);\r\n\tstrcat(HTML_String, \"\\\"></td>\");\r\n\tstrcat(HTML_String, \"<td><input type = \\\"number\\\"  onchange=\\\"sendVal('/?EthMac1='+this.value)\\\" name = \\\"EthMac\\\" min = \\\"0\\\" max = \\\"255\\\" step = \\\"1\\\" style= \\\"width:40px\\\" value = \\\"\");\r\n\tstrcati(HTML_String, Set.Eth_mac[1]);\r\n\tstrcat(HTML_String, \"\\\"></td>\");\r\n\tstrcat(HTML_String, \"<td><input type = \\\"number\\\"  onchange=\\\"sendVal('/?EthMac2='+this.value)\\\" name = \\\"EthMac\\\" min = \\\"0\\\" max = \\\"255\\\" step = \\\"1\\\" style= \\\"width:40px\\\" value = \\\"\");\r\n\tstrcati(HTML_String, Set.Eth_mac[2]);\r\n\tstrcat(HTML_String, \"\\\"></td>\");\r\n\tstrcat(HTML_String, \"<td><input type = \\\"number\\\"  onchange=\\\"sendVal('/?EthMac3='+this.value)\\\" name = \\\"EthMac\\\" min = \\\"0\\\" max = \\\"255\\\" step = \\\"1\\\" style= \\\"width:40px\\\" value = \\\"\");\r\n\tstrcati(HTML_String, Set.Eth_mac[3]);\r\n\tstrcat(HTML_String, \"\\\"></td>\");\r\n\tstrcat(HTML_String, \"<td><input type = \\\"number\\\"  onchange=\\\"sendVal('/?EthMac4='+this.value)\\\" name = \\\"EthMac\\\" min = \\\"0\\\" max = \\\"255\\\" step = \\\"1\\\" style= \\\"width:40px\\\" value = \\\"\");\r\n\tstrcati(HTML_String, Set.Eth_mac[4]);\r\n\tstrcat(HTML_String, \"\\\"></td>\");\r\n\tstrcat(HTML_String, \"<td><input type = \\\"number\\\"  onchange=\\\"sendVal('/?EthMac5='+this.value)\\\" name = \\\"EthMac\\\" min = \\\"0\\\" max = \\\"255\\\" step = \\\"1\\\" style= \\\"width:40px\\\" value = \\\"\");\r\n\tstrcati(HTML_String, Set.Eth_mac[5]);\r\n\tstrcat(HTML_String, \"\\\"></td></table>\");\r\n\r\n\tstrcat(HTML_String, \"</form><br><hr>\");\r\n\r\n\t//-------------------------------------------------------------\r\n\t// Checkboxes debugmode\r\n\tstrcat(HTML_String, \"<h2>Debugmode</h2>\");\r\n\tstrcat(HTML_String, \"<form>\");\r\n\tstrcat(HTML_String, \"<table>\");\r\n\tset_colgroup(300, 250, 150, 0, 0);\r\n\r\n\tstrcat(HTML_String, \"<tr> <td colspan=\\\"2\\\">debugmode sends messages to USB serial</td>\");\r\n\tstrcat(HTML_String, \"<td><input type= \\\"button\\\" onclick= \\\"sendVal('/?Save=true')\\\" style= \\\"width:120px\\\" value=\\\"Save\\\"></button></td>\");\r\n\r\n\tstrcat(HTML_String, \"<tr>\");\r\n\tstrcat(HTML_String, \"<td colspan=\\\"2\\\"><input type=\\\"checkbox\\\" onclick=\\\"sendVal('/?debugmode='+this.checked)\\\" name=\\\"debugmode\\\" id = \\\"Part\\\" value = \\\"1\\\" \");\r\n\tif (Set.debugmode == 1) strcat(HTML_String, \"checked \");\r\n\tstrcat(HTML_String, \"> \");\r\n\tstrcat(HTML_String, \"<label for =\\\"Part\\\"> general debugmode on</label>\");\r\n\tstrcat(HTML_String, \"</td></tr>\");\r\n\r\n\tstrcat(HTML_String, \"<tr>\");\r\n\tstrcat(HTML_String, \"<td colspan=\\\"3\\\"><input type=\\\"checkbox\\\" onclick=\\\"sendVal('/?debugmSW='+this.checked)\\\" name=\\\"debugmSW\\\" id = \\\"Part\\\" value = \\\"1\\\" \");\r\n\tif (Set.debugmodeSwitches == 1) strcat(HTML_String, \"checked \");\r\n\tstrcat(HTML_String, \"> \");\r\n\tstrcat(HTML_String, \"<label for =\\\"Part\\\"> debugmode switches on (display switch status)</label>\");\r\n\tstrcat(HTML_String, \"</td></tr>\");\r\n\r\n\tstrcat(HTML_String, \"<tr>\");\r\n\tstrcat(HTML_String, \"<td colspan=\\\"3\\\"><input type=\\\"checkbox\\\" onclick=\\\"sendVal('/?debugmRel='+this.checked)\\\" name=\\\"debugmRel\\\" id = \\\"Part\\\" value = \\\"1\\\" \");\r\n\tif (Set.debugmodeRelay == 1) strcat(HTML_String, \"checked \");\r\n\tstrcat(HTML_String, \"> \");\r\n\tstrcat(HTML_String, \"<label for =\\\"Part\\\"> debugmode relais on</label>\");\r\n\tstrcat(HTML_String, \"</td></tr>\");\r\n\r\n\tstrcat(HTML_String, \"<tr>\");\r\n\tstrcat(HTML_String, \"<td colspan=\\\"3\\\"><input type=\\\"checkbox\\\" onclick=\\\"sendVal('/?debugmDatFromAOG='+this.checked)\\\" name=\\\"debugmDatFromAOG\\\" id = \\\"Part\\\" value = \\\"1\\\" \");\r\n\tif (Set.debugmodeDataFromAOG == 1) strcat(HTML_String, \"checked \");\r\n\tstrcat(HTML_String, \"> \");\r\n\tstrcat(HTML_String, \"<label for =\\\"Part\\\"> debugmode data from AgOpenGPS on</label>\");\r\n\tstrcat(HTML_String, \"</td></tr>\");\r\n\r\n\tstrcat(HTML_String, \"<tr>\");\r\n\tstrcat(HTML_String, \"<td colspan=\\\"3\\\"><input type=\\\"checkbox\\\" onclick=\\\"sendVal('/?debugmDatToAOG='+this.checked)\\\" name=\\\"debugmDatToAOG\\\" id = \\\"Part\\\" value = \\\"1\\\" \");\r\n\tif (Set.debugmodeDataToAOG == 1) strcat(HTML_String, \"checked \");\r\n\tstrcat(HTML_String, \"> \");\r\n\tstrcat(HTML_String, \"<label for =\\\"Part\\\"> debugmode data to AgOpenGPS on</label>\");\r\n\tstrcat(HTML_String, \"</td></tr>\");\r\n\r\n\tstrcat(HTML_String, \"</table></form><br><hr>\");\r\n\r\n\t//-------------------------------------------------------------\r\n\t// firmware update\r\n\r\n\tstrcat(HTML_String, \"<h2>Firmware Update for ESP32</h2>\");\r\n\tstrcat(HTML_String, \"<form>\");\r\n\tstrcat(HTML_String, \"<table>\");\r\n\tset_colgroup(300, 250, 150, 0, 0);\r\n\r\n\tstrcat(HTML_String, \"<tr> <td colspan=\\\"3\\\">build a new firmware with Arduino IDE selecting</td> </tr>\");\r\n\tstrcat(HTML_String, \"<tr> <td colspan=\\\"3\\\">Sketch -> Export compiled Binary</td> </tr>\");\r\n\tstrcat(HTML_String, \"<tr> <td colspan=\\\"3\\\">upload this file via WiFi/Ethernet connection</td> </tr>\");\r\n\r\n\tstrcat(HTML_String, \"<tr> <td colspan=\\\"3\\\">&nbsp;</td> </tr>\");\r\n\tstrcat(HTML_String, \"<tr><td></td>\");\r\n\t//button\r\n\tstrcat(HTML_String, \"<td><input type='submit' onclick='openUpload(this.form)' value='Open Firmware uploader'></td></tr>\");\r\n\r\n\tstrcat(HTML_String, \"<script>\");\r\n\tstrcat(HTML_String, \"function openUpload(form)\");\r\n\tstrcat(HTML_String, \"{\");\r\n\tstrcat(HTML_String, \"window.open('/serverIndex')\");\r\n\tstrcat(HTML_String, \"}\");\r\n\tstrcat(HTML_String, \"</script>\");\r\n\r\n\tstrcat(HTML_String, \"</table></form><br><hr>\");\r\n\r\n\t//-------------------------------------------------------------\r\n\tstrcat(HTML_String, \"</font>\");\r\n\tstrcat(HTML_String, \"</body>\");\r\n\tstrcat(HTML_String, \"</html>\");\r\n\r\n\t//script to send values from webpage to ESP for process request\r\n\tstrcat(HTML_String, \"<script>\");\r\n\tstrcat(HTML_String, \"function sendVal(ArgStr)\");\r\n\tstrcat(HTML_String, \"{\");\r\n\tstrcat(HTML_String, \"  var xhttp = new XMLHttpRequest();\");\r\n\tstrcat(HTML_String, \"  xhttp.open(\\\"GET\\\",ArgStr, true);\");\r\n\tstrcat(HTML_String, \"  xhttp.send();\");\r\n\tstrcat(HTML_String, \" if (ArgStr == '/?ACTION=\");\r\n\tstrcati(HTML_String, ACTION_LoadDefaultVal);\r\n\tstrcat(HTML_String, \"') { window.setTimeout('location.reload()',400); }\");\r\n\tstrcat(HTML_String, \"}\");\r\n\tstrcat(HTML_String, \"</script>\");\r\n\r\n}\r\n\r\n\r\n\r\n//-------------------------------------------------------------------------------------------------\r\n\r\nvoid handleNotFound() {\r\n\tconst char* notFound =\r\n\t\t\"<!doctype html>\"\r\n\t\t\"<html lang = \\\"en\\\">\"\r\n\t\t\"<head>\"\"\"\r\n\t\t\"<meta charset = \\\"utf - 8\\\">\"\r\n\t\t\"<meta http - equiv = \\\"x - ua - compatible\\\" content = \\\"ie = edge\\\">\"\r\n\t\t\"<meta name = \\\"viewport\\\" content = \\\"width = device - width, initial - scale = 1.0\\\">\"\r\n\t\t\"<title>Redirecting</title>\"\r\n\t\t\"</head>\"\r\n\t\t\"<body onload = \\\"redirect()\\\">\"\r\n\t\t\"<h1 style = \\\"text - align: center; padding - top: 50px; display: block; \\\"><br>404 not found<br><br>Redirecting to settings page in 3 secs ...</h1>\"\r\n\t\t\"<script>\"\r\n\t\t\"function redirect() {\"\r\n\t\t\"setTimeout(function() {\"\r\n\t\t\"    window.location.replace(\\\"/root\\\");\"//new landing page\r\n\t\t\"}\"\r\n\t\t\", 3000);\"\r\n\t\t\"}\"\r\n\t\t\"</script>\"\r\n\t\t\"</body>\"\r\n\t\t\"</html>\";\r\n\r\n\tWiFi_Server.sendHeader(\"Connection\", \"close\");\r\n\tWiFi_Server.send(200, \"text/html\", notFound);\r\n\tif (Set.debugmode) { Serial.println(\"redirecting from 404 not found to Webpage root\"); }\r\n}\r\n\r\n//-------------------------------------------------------------------------------------------------\r\nvoid set_colgroup(int w1, int w2, int w3, int w4, int w5) {\r\n\tstrcat(HTML_String, \"<colgroup>\");\r\n\tset_colgroup1(w1);\r\n\tset_colgroup1(w2);\r\n\tset_colgroup1(w3);\r\n\tset_colgroup1(w4);\r\n\tset_colgroup1(w5);\r\n\tstrcat(HTML_String, \"</colgroup>\");\r\n}\r\n\r\nvoid set_colgroup(int w1, int w2, int w3, int w4, int w5, int w6) {\r\n\tstrcat(HTML_String, \"<colgroup>\");\r\n\tset_colgroup1(w1);\r\n\tset_colgroup1(w2);\r\n\tset_colgroup1(w3);\r\n\tset_colgroup1(w4);\r\n\tset_colgroup1(w5);\r\n\tset_colgroup1(w6);\r\n\tstrcat(HTML_String, \"</colgroup>\");\r\n}\r\nvoid set_colgroup(int w1, int w2, int w3, int w4, int w5, int w6, int w7) {\r\n\tstrcat(HTML_String, \"<colgroup>\");\r\n\tset_colgroup1(w1);\r\n\tset_colgroup1(w2);\r\n\tset_colgroup1(w3);\r\n\tset_colgroup1(w4);\r\n\tset_colgroup1(w5);\r\n\tset_colgroup1(w6);\r\n\tset_colgroup1(w7);\r\n\tstrcat(HTML_String, \"</colgroup>\");\r\n}\r\n//------------------------------------------------------------------------------------------\r\nvoid set_colgroup1(int ww) {\r\n\tif (ww == 0) return;\r\n\tstrcat(HTML_String, \"<col width=\\\"\");\r\n\tstrcati(HTML_String, ww);\r\n\tstrcat(HTML_String, \"\\\">\");\r\n}\r\n//---------------------------------------------------------------------\r\nvoid strcatf(char* tx, float f, byte leng, byte dezim) {\r\n\tchar tmp[8];\r\n\tdtostrf(f, leng, dezim, tmp);//f,6,2,tmp\r\n\tstrcat(tx, tmp);\r\n}\r\n//---------------------------------------------------------------------\r\nvoid strcati(char* tx, int i) {\r\n\tchar tmp[8];\r\n\r\n\titoa(i, tmp, 10);\r\n\tstrcat(tx, tmp);\r\n}\r\n"}}}